# Python机器学习框架，选TensorFlow还是PyTorch？

<img src="https://pics2.baidu.com/feed/9f510fb30f2442a719426d5926002143d013024e.jpeg?token=067bb937c13643c9a247819b69f3c7b7" alt="Python" title="Python" style="zoom: 50%;" />

Python是目前发展最快的编程语言，这是因为它简单、易用、免费，而且可应用于许多类型的任务。Python具有高效语法、易学性以及可与其他语言（如C和C++）轻松集成等一系列优点。

伴随着人们越来越对机器学习和人工智能感兴趣，出现了大量的面向机器学习和数据科学应用的开源软件库和开发框架。有一些软件库可以在多种应用程序中使用，比如：

·   自然语言处理（TensorFlow）

·   数据可视化和数据分析（Theano）

·   图像识别（Caffe）

·   预测与推荐

在众多的开源软件库和开发框架里，如何来给自己的应用，选择最合适的那一款呢？你可能需要从以下方面来做决定：

·   你熟知机器学习的基础知识吗？

·   你是准备将该框架用于经典机器学习算法还是用于深度学习算法？

·   你的应用是什么类型的：大量的数值计算、复杂的数据分析、图像分析，还是学术研究？

·   你是否会使用额外的硬件（如GPU和TPU）、软件或云服务来处理庞大的数据集？

每个开发框架都有其自身的优势和劣势，权衡利弊，才能选择到最合适的那个框架。

例如，如果你是机器学习方面的菜鸟，或者计划采用经典的机器学习算法，那么Sci-kit可能是最佳选择。而如果你需要进行大量的数值计算，那么Theano会是不错的选择。

| **软件库**    | **最佳应用**   | **能否运行在外部硬件上** | **机器学习还是深度学习** | **机器学习掌握度** | **学习难度** |
| ------------- | -------------- | ------------------------ | ------------------------ | ------------------ | ------------ |
| Sci-Kit Learn | 机器学习       | 不能                     | 机器学习                 | 初学               | 较低         |
| PyTorch       | 学术研究       | 能                       | 都可以                   | 初学               | 低           |
| Caffe         | 图像处理       | 能                       | 都可以                   | 中等               | 低           |
| TensorFlow    | 大型数据集处理 | 能                       | 都可以                   | 较高               | 高           |
| Theano        | 高速计算       | 能                       | 都可以                   | 深度               | 非常高       |

 

下面，让我们具体来了解下这5个开源的Python开发框架的优劣势。根据它们的受欢迎程度，我们暂且给它们排个名，希望能给你一点参考，以便你能够选到最称心的那一个。

## **第五名**  **Sci-Kit Learn**

**适合**：机器学习初学者

Sci-kit Learn提供许多经典的机器学习算法，如支持向量机（Support Vector Machines）、K近邻（K-Nearest Neighbors）、随机森林（Random Forests）和回归（regression）算法。它们涵盖监督学习和无监督学习，是统计建模的有效方式。

Sci-kit Learn构建于其他Python库SciPy、Numpy和Matplotlib。它的一些核心算法使用Cython语言编写。

**优势**：

·   非常适合机器学习初学者；

·   适合数据挖掘，以及其他一些简单项目，例如对小数据集或标记数据集进行预测。

**劣势**：

·   不支持人工神经网络；

·   不支持GPU计算。

这个框架与其他框架的区别在于，它为开发者提供了简单的开发界面，初学者能够较快地熟悉这个平台，不需要执行特别细节的算法操作。

此外，Sci-kit Learn易于运行和调试，在网上你可以找到一些简单的教程，帮助你理解这个框架。

但是，对于经验丰富的开发者来说，他们可能看不上Sci-kit Learn，因为他们可能希望手动去优化底层算法，但Sci-kit Learn不支持这样做。

## **第四名** **Theano**

**适合**：需要在单个GPU上运行高速计算的资深开发者

如果你正在寻找可以像专业人士一样处理数值的框架，选择Theano一定不会错。

Theano完美适合数值计算，可以帮助你高效地处理具有多维数组的数学表达式。

**优势**：

·   高效处理大型多维数据集；

·   支持开发者微调底层算法和创建新模型。

**劣势**：

·   需要全新学习，不容易上手；

·   不支持GPU扩展。

与Sci-kit Learn相比，Theano仅适合深度学习开发专家。

要使用这个框架，你必须具备很好的代码编写能力。Theano的语法与NumPy有较为紧密的联系，它的代码可以在CPU和GPU上高效运行。

与Sci-kit Learn不同，Theano允许开发者对模型进行调优。开发者甚至可以在Theano框架上使用和测试许多不常见的模型。

虽然Theano在单个GPU上的运行效果优于TensorFlow，但在多个GPU上同时运行时，它的性能弱于TensorFlow。

不过，由于Theano存在的时间更长，它的指导文档也更多。但是Theano有一个致命缺点，那就是它的制造商MLA已决定在1.0版本发布后停止维护该框架。尽管如此，对于狂热的深度学习爱好者来说，它仍然是一个不错的选择。

## **第三名** **Caffe**

**适合**：中级程序员和图像处理

Caffe是快速特征嵌入卷积架构（Convolutional Architecture for Fast Feature Embedding）的缩写。它是计算机视觉、图像处理和前馈网络的首选框架。

该框架采用基于Python的API，主要使用C++语言编写。Caffe中的模型由Protobuf配置文件体现。在所有深度学习框架中，Caffe能实现最快的卷积神经网络。

Caffe能高效地处理图像分割和分类任务。在单个GPU上，Caffe每天可以处理超过6000万张图片！

**优势**：

·   提供出色的图像识别模型；

·   最快的卷积神经网络框架；

·   配置和优化模型时，不需要编写底层代码。

**劣势**：

·   不适合循环神经网络；

·   指导文档不全；

·   创建新的网络层需要定义完整的前向、后向和梯度更新。

Caffe最棒的一点是，配置和优化模型时，不需要编写底层代码，这为开发者减少了代码工作量。

因此，如果你有大量的图像集，需要对其进行分类或运行一些回归算法，你可以快速应用深度学习网络，而无需编写任何代码。

你也可以在多个GPU上进行训练，不过有一些限制条件，例如你不能并行处理模型或数据。

Caffe框架的另一个优点是，它有一个非常成熟的开发者社区。例如在“ModelZoo”板块，你可以找到许多现成的卷积神经网络模型，包括AlexNet、GoogleNet、NIN等。

Caffe框架非常适合卷积神经网络和图像处理，但它不适合循环神经网络和涉及文本、声音和时间序列数据的应用。此外，如果要实现多个网络层，创建新层会比较辛苦，因为每个新层都需要定义完整的前向、后向和梯度更新。

## **第二名** **PyTorch**

**适合**：学术研究和实际生产

PyTorch是使用Python、C++和CUDA后端开发的。PyTorch由Facebook的人工智能研究团队创建，虽然出现的时间不长，但已经可以与TensorFlow并驾齐驱。许多人预测，它很快会成为其他框架的首选替代品。

**优势**：

·   编码简单，入门容易；

·   支持动态图，支持即时调整；

·   支持GPU加速。

**劣势**：

·   出现时间较短，所以它的社区较小，在线资源较少。

PyTorch尤其受到入门开发者的喜爱，主要是因为它易于编码，但该框架主要是高级和低级API的混合体。它既适用于学术用途，也适用于专业的深度学习模型开发。

它提供大量的预训练模型。在PyTorch中编码时，你不需要像其他编码语言那样，将数字分类为“int”、“short”或“double”数据类型。你可以直观地看到操作和函数的性能表现。

该框架的亮点在于它支持动态图。TensorFlow、Theano及其它们的衍生框架只允许你创建静态图，因此你必须先为模型定义整个图形，然后才能运行模型。相比而言，PyTorch更灵活，你可以在运行时定义或调整图形，你可以使用变长输入，特别是在循环神经网络中，这点尤其有用。

PyTorch拥有强大GPU加速功能，加快开发速度。

不过，PyTorch的主要缺点是框架仍在发展中，你可能会遇到一些bug。此外，由于其成立时间较短，官方文档不够完整，其他能找到的学习资源也较少。但从长期发展来看，这些问题会逐渐得到解决，因为越来越多的开发者开始转向PyTorch，社区正在稳定健康地发展。

## **第一名** **TensorFlow**

**适合**：中级开发者，或者开发面向大量数据集的生产模型

TensorFlow目前被誉为最好的机器学习框架。在很短的时间内，它已经成为许多开发者的最爱，社区在快速地发展壮大。

该框架由Google Brain团队开发，支持从Linux到Android的所有平台。这个高级框架允许你使用兼容库来运行低级代码。你可以实时查看模型训练的进度、各种指标统计，而不用过多关注其他不必要的细节。

**优势**：

·   灵活实现；

·   提供丰富的机器学习模型和应用软件包；

·   软硬件可扩展；

·   成熟的在线社区。

**弱点**：

·   仅支持英伟达的GPU；

·   学习难度较大。

与其他框架不同，TensorFlow图中的节点代表数学运算，而图的边缘代表多维数组（张量）。这些张量在节点之间流动，使你可以更灵活地创建新节点。

TensorFlow提供大量模型可供选择。该框架预装了可让你执行语音识别和机器翻译的软件包，以及可让你运行回归、分类、神经网络和各种其他算法的模型。

TensorFlow的强大体现在它的计算能力。目前，TensorFlow是分布式处理领域最强的框架。它具有卓越的可扩展性，你可以将计算任务部署到多个CPU、GPU、服务器、移动设备和Google Cloud机器学习引擎上。你无需重写任何代码就可以完成这些部署，这真的很强大！

不过，TensorFlow主要的缺点是目前它只支持英伟达的GPU。此外，在循环神经网络方面，它的表现要比其他框架弱些，学习难度也比Sci-kit和PyTorch要更高点。

不过，有了Google的强大支持和成熟的在线社区，TensorFlow注定会发展得越来越好。

## **总结**

综上所述，TensorFlow因其卓越的扩展性和分布式处理能力受到了极大的欢迎，PyTorch因其较低的学习难度和良好的动态图处理能力也收获了越来越多的追随者。如今这两个框架广泛应用于各种各样的项目中。其他框架Caffe、Theano和Sci-Kit Learn则针对各自适合的特定领域的项目，应用面稍窄。

仁者见仁智者见智，总有一款开发框架适合你。在这个机器学习和人工智能的世代，多学习点，总不会错！